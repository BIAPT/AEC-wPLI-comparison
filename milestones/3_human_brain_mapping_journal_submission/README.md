# Human Brain Mapping Submission
This modified version of the code is improved with the comments from our reviewers. Below you will find explanation on how to run the analysis.

## Step 0: Preparation
- Make sure to have a compute canada account on the Beluga cluster.
- Install MATLAB 2020a with the Parallel Toolbox
- Follow the section [Using the MATLAB Parallel Server](https://docs.computecanada.ca/wiki/MATLAB) on compute canada documentation
- Get the cleaned source localized EEG data of all 9 participant (these are .mat files generated by BrainStorm)
- Transfer it inside your HPC folder using [Globus](https://globus.computecanada.ca/)

## Step 1: Generate the AEC and wPLI Graphs
- Open MATLAB2020a and navigate to the folder`task_0a_generate_aec_graph`. Once there open the ccSBATCH.m and modify the parameters to match the resource you want to use and your account on compute canada.
- Open the `generate_aec.m` file and modify the parameter relating to your cluster setup. There are some path that needs to be modified in order for the input/output to make sense in your section of the cluster.
- Once ready you can run the following commands: `cluster = parcluster('beluga'); ccSBATCH.submitTo(cluster)`, this will send the job to your cluster
- Repeat the same procedure for `task_0b_generate_wpli_graph`. You do not have to wait for the AEC graph to be done before you start running the wPLI computation. Both code use the same EEG source localized data as input, but they do not step on each other while calculating the graphs.

**Word of Caution:** The speed up that you can gain from the parallelization really depends on what is the availability of the cluster. If you try to use up to 960 cores you might wait a long time before it becomes available (I've waited 8+h and still wasn't scheduled). However, if you use only 40 cores on 1 node you will most likely get scheduled right away. There is a balance to strike and it is still not obvious what is the best course of action. Sometime you get lucky sometime you don't.

## Step 2: Generate the Feature Dataframe
